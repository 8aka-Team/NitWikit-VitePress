import{_ as r,c as p,a5 as d,G as i,w as n,j as l,a as s,B as o,o as u}from"./chunks/framework.O9ad3XaM.js";const f=JSON.parse('{"title":"搭建","description":"","frontmatter":{"title":"搭建","sidebar_position":1},"headers":[],"relativePath":"Java/process/cross-server/build-up/Velocity/build-up.md","filePath":"nitwikit/docs-java/process/cross-server/build-up/Velocity/build-up.md","lastUpdated":1749617524000}'),c={name:"Java/process/cross-server/build-up/Velocity/build-up.md"};function h(k,a,g,y,b,m){const e=o("TabItem"),t=o("Tabs");return u(),p("div",null,[a[2]||(a[2]=d(`<h1 id="搭建" tabindex="-1">搭建 <a class="header-anchor" href="#搭建" aria-label="Permalink to &quot;搭建&quot;">​</a></h1><h2 id="下载" tabindex="-1">下载 <a class="header-anchor" href="#下载" aria-label="Permalink to &quot;下载&quot;">​</a></h2><p>在 <a href="/docs-java/process/cross-server/server-core-choose">核心选择</a> 找到 Velocity 然后下载</p><h2 id="启动" tabindex="-1">启动 <a class="header-anchor" href="#启动" aria-label="Permalink to &quot;启动&quot;">​</a></h2><p>创建一个新的文件夹将核心放进去</p><p>并且使用参数启动以生成初始文件</p><p>如果想进一步优化可以使用 JVM 参数 <a href="https://docs.papermc.io/velocity/getting-started#launching-velocity-under-windows" target="_blank" rel="noreferrer">Velocity 官方</a>有推荐的 Flags</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xms1024M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xmx1024M</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -jar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 核心名字.jar</span></span></code></pre></div><h2 id="velocity-配置" tabindex="-1">Velocity 配置 <a class="header-anchor" href="#velocity-配置" aria-label="Permalink to &quot;Velocity 配置&quot;">​</a></h2><p>打开 <code>velocity.toml</code></p><p>找到并修改以下内容：</p><blockquote><p>在 <strong>[servers]</strong> 那里该填什么？</p><blockquote><p>答: <code>子服名 = &quot;子服地址&quot;</code></p><p>如 <code>login = &quot;0.0.0.0:25501&quot;</code></p></blockquote></blockquote><div class="danger custom-block"><p class="custom-block-title">危险</p><p>中文需要用引号括起来。如<code>&quot;登录服&quot; = &quot;0.0.0.0:25501&quot;</code></p></div><p><a href="./velocity.toml">详细配置文件讲解</a></p><div class="language-toml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">toml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># velocity 端的端口号，数字 1000~65536 随意</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">bind = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0:25577&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 正版验证，有 1.19.1+ 的子服不建议开启此项</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">online-mode = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1.13+ 这里填 modern 1.12-填 bungeeguard</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">player-info-forwarding-mode = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;modern&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 是否应将服务器列表 ping 请求传递给后端服务器？</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 可用选项：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - &quot;disabled&quot;：不会进行任何传递。velocity.toml 和 server-icon.png 将确定初始服务器列表 ping 响应。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - &quot;mods&quot;：仅将后端服务器的 mod 列表传递到响应中。将使用具有 mod 列表的后端服务器的第一个服务器。如果无法联系后端服务器，则 Velocity 不会显示任何 mod 信息。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - &quot;description&quot;：使用后端服务器的描述和 mod 列表。将使用响应的第一个服务器列表中的第一个服务器 (或强制主机) 进行描述和 mod 列表。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># - &quot;all&quot;：将后端服务器的响应用作代理响应。如果无法联系服务器，则使用 Velocity 配置。</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 人话，motd 插件在代理端用&quot;disabled&quot;，否则用&quot;all&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ping-passthrough = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;all&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 子服名称和地址，名称不可包含”.”</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">servers</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## 登录服</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">login = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0:25501&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## 生存服</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">survival = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0.:25502&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">## 资源服</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">resource = </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;0.0.0.0:25503&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 尝试连接子服的先后顺序</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">try = [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;login&quot;</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">，&quot;survival&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 建议删除此项所有值</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forced-hosts</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&quot;lobby.example.com&quot; = [</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    &quot;lobby&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div><h2 id="子服配置" tabindex="-1">子服配置 <a class="header-anchor" href="#子服配置" aria-label="Permalink to &quot;子服配置&quot;">​</a></h2><p>Velocity 支持将玩家信息 (如 IP 地址、UUID 和皮肤) 转发到你的服务器。Velocity 支持三种转发格式：</p><ul><li><strong>Velocity Modern 转发</strong> (现代转发) 是一种自定义的转发格式 (modern 转发)，它更安全。</li><li><strong>BungeeCord 转发</strong>(也称为<em>传统转发</em>)，它有更好的兼容性但安全性较低。</li><li><strong>BungeeGuard</strong>，与传统 BungeeCord 转发相同，但包含了一个密钥。它比单独的 BungeeCord 转发更好，但不如 Velocitymodern 转发理想。</li></ul><p>你只能选择这些转发格式中的一种。目前不可能“混合匹配”转发模式或同时使用所有转发格式。一般来说，如果你只支持使用 Minecraft 1.13 及更新版本的客户端，请使用 Velocity Modern 转发； 否则，你必须使用 BungeeCord 转发。</p>`,19)),i(t,null,{default:n(()=>[i(e,{value:"Modern",label:"现代转发(Modern Forwarding)",default:""},{default:n(()=>a[0]||(a[0]=[l("p",null,[l("strong",null,[l("code",null,"modern"),s(" 转发")]),s(" 是 Velocity 的原生格式，以高效的二进制格式转发所有玩家信息，并采用 MAC 代码增加安全性，使非法服务器难以绕过你的 Velocity 代理。但它"),l("strong",null,"仅支持 Minecraft 1.13 或更高版本"),s("。")],-1),l("div",{class:"warning custom-block"},[l("p",{class:"custom-block-title"},"警告"),l("ul",null,[l("li",null,[l("code",null,"modern"),s(" 转发与 "),l("strong",null,"Minecraft 1.13 以下版本"),s(" 和 "),l("strong",null,[l("a",{href:"https://www.spigotmc.org/resources/.7201",target:"_blank",rel:"noreferrer"},"ProtocolSupport"),s(" 插件")]),s(" 不兼容。如果使用这些，你需要使用传统的 BungeeCord 兼容转发。")])])],-1),l("ol",null,[l("li",null,[s("在 "),l("code",null,"velocity.toml"),s(" 文件中将 "),l("code",null,"player-info-forwarding"),s(" 设置为 "),l("code",null,"modern"),s("。")]),l("li",null,"确保你的服务器已正确配置以使用 Velocity 转发。")],-1),l("h3",{id:"为-paper-配置现代转发",tabindex:"-1"},[s("为 Paper 配置现代转发 "),l("a",{class:"header-anchor",href:"#为-paper-配置现代转发","aria-label":'Permalink to "为 Paper 配置现代转发"'},"​")],-1),l("ul",null,[l("li",null,[s("Paper "),l("strong",null,"1.14 及以上版本"),s(" 以及 "),l("strong",null,"1.13.1/1.13.2 版本 377 及以上版本"),s(" 原生支持 Velocity 现代转发。")])],-1),l("ol",null,[l("li",null,[s("在 "),l("code",null,"server.properties"),s(" 文件中禁用 "),l("code",null,"online-mode"),s(" 设置，以防止服务器自行验证玩家身份。")]),l("li",null,[s("如果之前已启用 BungeeCord 转发，需在 "),l("code",null,"spigot.yml"),s(" 中将 "),l("code",null,"settings.bungeecord"),s(" 设置为 "),l("code",null,"false"),s("。")]),l("li",null,[s("在 "),l("code",null,"config/paper-global.yml"),s(" 中： "),l("ul",null,[l("li",null,[s("设置 "),l("code",null,"proxies.velocity.enabled"),s(" 为 true。")]),l("li",null,[s("设置 "),l("code",null,"proxies.velocity.secret"),s(" 以匹配你的 "),l("code",null,"forwarding.secret"),s(" 文件中的密钥。")]),l("li",null,[s("设置 "),l("code",null,"proxies.velocity.online-mode"),s(" 与你的 "),l("code",null,"velocity.toml"),s(" 中的 "),l("code",null,"online-mode"),s(" 一致。")])])]),l("li",null,"编辑完成后，重新启动服务器。")],-1),l("p",null,[l("strong",null,"注意"),s("：如果你使用的是 Paper "),l("strong",null,"1.18.2 或更低版本"),s("，请在 "),l("code",null,"paper.yml"),s(" 文件中查找相关设置。")],-1),l("details",null,[l("summary",null,"点击展开 - 为 Fabric/Forge 配置现代转发"),l("h3",{id:"为-fabric-配置现代转发",tabindex:"-1"},[s("为 Fabric 配置现代转发 "),l("a",{class:"header-anchor",href:"#为-fabric-配置现代转发","aria-label":'Permalink to "为 Fabric 配置现代转发"'},"​")]),l("ul",null,[l("li",null,[s("使用名为 "),l("strong",null,"FabricProxy-Lite"),s(" 的 mod，可以在 Fabric 上使用修改过的服务器与 Velocity 现代转发。")])]),l("h3",{id:"为-forge-配置现代转发",tabindex:"-1"},[s("为 Forge 配置现代转发 "),l("a",{class:"header-anchor",href:"#为-forge-配置现代转发","aria-label":'Permalink to "为 Forge 配置现代转发"'},"​")]),l("ul",null,[l("li",null,[s("使用名为 "),l("strong",null,"ProxyCompatibleForge"),s(" 的 mod，可以在 Forge "),l("strong",null,"1.16.5 或更高版本"),s(" 的修改过的服务器上使用 Velocity 现代转发。")])])],-1)])),_:1}),i(e,{value:"legacy",label:"传统 BungeeCord 兼容转发 (Legacy Forwarding)",default:""},{default:n(()=>a[1]||(a[1]=[l("div",{class:"warning custom-block"},[l("p",{class:"custom-block-title"},"警告"),l("ul",null,[l("li",null,[s("传统转发 "),l("strong",null,"本质上是不安全的"),s("。如果必须使用，应了解如何正确保护你的服务器。")])]),l("ol",null,[l("li",null,[l("code",null,"legacy"),s(" 转发是 BungeeCord 启用 IP 转发时使用的玩家信息转发协议。")]),l("li",null,[s("它广泛支持且兼容性强，但 "),l("strong",null,"不安全"),s("。")]),l("li",null,[s("在 "),l("code",null,"velocity.toml"),s(" 中将 "),l("code",null,"player-info-forwarding"),s(" 设置为 "),l("code",null,"legacy"),s("。")]),l("li",null,"确保服务器能接受 Velocity 发送的转发玩家数据。")])],-1),l("h3",{id:"传统转发增加安全性",tabindex:"-1"},[s("传统转发增加安全性 "),l("a",{class:"header-anchor",href:"#传统转发增加安全性","aria-label":'Permalink to "传统转发增加安全性"'},"​")],-1),l("ul",null,[l("li",null,[s("对于托管在共享主机上的代理，Velocity 可选地支持 "),l("strong",null,"BungeeGuard"),s("。 "),l("ul",null,[l("li",null,[s("将 "),l("code",null,"velocity.toml"),s(" 中的 "),l("code",null,"player-info-forwarding"),s(" 设置为 "),l("code",null,"bungeeguard"),s("。")]),l("li",null,[s("在 BungeeGuard 配置的令牌部分添加 "),l("code",null,"forwarding.secret"),s(" 文件中的值。")])])])],-1),l("h3",{id:"为-spigot-paper-配置传统转发",tabindex:"-1"},[s("为 Spigot / Paper 配置传统转发 "),l("a",{class:"header-anchor",href:"#为-spigot-paper-配置传统转发","aria-label":'Permalink to "为 Spigot / Paper 配置传统转发"'},"​")],-1),l("ol",null,[l("li",null,[s("在 "),l("code",null,"spigot.yml"),s(" 中将 "),l("code",null,"settings.bungeecord"),s(" 设置为 "),l("code",null,"true"),s("。")]),l("li",null,"重新启动服务器。")],-1),l("details",null,[l("summary",null,"点击展开 - 为 Sponge/Fabric 配置传送转发"),l("h3",{id:"为-sponge-配置传统转发",tabindex:"-1"},[s("为 Sponge 配置传统转发 "),l("a",{class:"header-anchor",href:"#为-sponge-配置传统转发","aria-label":'Permalink to "为 Sponge 配置传统转发"'},"​")]),l("ol",null,[l("li",null,"停止服务器。"),l("li",null,[s("在 "),l("code",null,"config/sponge/global.conf"),s(" 文件中将 "),l("code",null,"modules.bungeecord"),s(" 和 "),l("code",null,"bungeecord.ip-forwarding"),s(" 设置为 true。")]),l("li",null,"重新启动 Sponge 服务器。")]),l("h3",{id:"为-fabric-配置传统转发",tabindex:"-1"},[s("为 Fabric 配置传统转发 "),l("a",{class:"header-anchor",href:"#为-fabric-配置传统转发","aria-label":'Permalink to "为 Fabric 配置传统转发"'},"​")]),l("p",null,[l("strong",null,"警告"),s("：不再有任何积极支持传统转发的 mod。"),l("strong",null,"请改用 Velocity 现代转发"),s("。")])],-1)])),_:1})]),_:1}),a[3]||(a[3]=l("h2",{id:"加入",tabindex:"-1"},[s("加入 "),l("a",{class:"header-anchor",href:"#加入","aria-label":'Permalink to "加入"'},"​")],-1)),a[4]||(a[4]=l("p",null,[s("见 "),l("a",{href:"/docs-java/process/cross-server/join-server"},"加入服务器")],-1))])}const F=r(c,[["render",h]]);export{f as __pageData,F as default};
