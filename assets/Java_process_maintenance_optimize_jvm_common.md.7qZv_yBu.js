import{_ as s,c as i,a5 as e,o as t}from"./chunks/framework.O9ad3XaM.js";const c=JSON.parse('{"title":"通用优化参数","description":"","frontmatter":{"sidebar_position":2,"title":"通用优化参数","slug":"/optimize/jvm/common"},"headers":[],"relativePath":"Java/process/maintenance/optimize/jvm/common.md","filePath":"nitwikit/docs-java/process/maintenance/optimize/jvm/common.md","lastUpdated":1732847174000}'),l={name:"Java/process/maintenance/optimize/jvm/common.md"};function p(n,a,h,d,o,r){return t(),i("div",null,a[0]||(a[0]=[e('<h1 id="通用参数" tabindex="-1">通用参数 <a class="header-anchor" href="#通用参数" aria-label="Permalink to &quot;通用参数&quot;">​</a></h1><h2 id="大页支持" tabindex="-1">大页支持 <a class="header-anchor" href="#大页支持" aria-label="Permalink to &quot;大页支持&quot;">​</a></h2><p>注意在 WINDOWS 上使用大页，必须要以管理员启动</p><p>当然，在动手前，让我们先试一试是不是系统已经支持了这项功能 ，在控制台执行此命令</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xlog:gc+init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -XX:+UseLargePages</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xmx1g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -version</span></span></code></pre></div><p>如果出现了以下字样，那么说明不完全兼容：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UseLargePages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> disabled,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> large</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pages</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configured</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> and</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> available</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> on</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> the</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> system.</span></span></code></pre></div><p>那么就说明当前系统并不支持大页，不过不要急，可以试一下这一行命令：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">java</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xlog:gc+init</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -XX:+UseTransparentHugePages</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Xmx1g</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -version</span></span></code></pre></div><p>如果看到 <code>Large Page Support: Enabled (Transparent)</code> ，表示你的系统支持透明大页</p><p>但是如果你依然不支持或者想要追求极致性能，可以去百度搜索当前的系统如何开启大页，</p><p>这里就不再过多的赘述了。(LargePages 对服务器提升相当巨大，在我的电脑上，它提升了 50%的性能)</p><p>如果支持 LargePages ，加上此参数</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-XX:+UseLargePages</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  -XX:LargePageSizeInBytes=2m</span></span></code></pre></div><p>如果支持 TransparentHugePages (不要把两个都加上，优先 LargePages)，加上此参数</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-XX:+UseTransparentHugePages</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -XX:LargePageSizeInBytes=2m</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>在某些服务器上，开启大页后，会延长 JVM 的启动时间，时间从十秒到十分钟不等</p></div><h2 id="simd" tabindex="-1">SIMD <a class="header-anchor" href="#simd" aria-label="Permalink to &quot;SIMD&quot;">​</a></h2><p>如果你使用的是 Pufferfish 的分支(Purpur，Leaf，Leaves，Gale)，你可以添加此参数</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">--add-modules</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jdk.incubator.vector</span></span></code></pre></div><h2 id="下载源加速" tabindex="-1">下载源加速 <a class="header-anchor" href="#下载源加速" aria-label="Permalink to &quot;下载源加速&quot;">​</a></h2><p>默认的 SpigotLibraryLoader 下载源或插件使用 PaperLibraryLoader 添加的 Maven 中心仓库下载源在国内访问很慢，</p><p>如果你使用的是 Leaf，你可以添加参数使用国内下载源：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-DLeaf.library-download-repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=https://maven.aliyun.com/repository/public</span></span></code></pre></div><h2 id="中文编码" tabindex="-1">中文编码 <a class="header-anchor" href="#中文编码" aria-label="Permalink to &quot;中文编码&quot;">​</a></h2><p>防止乱码</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-Dfile.encoding</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=UTF-8</span></span></code></pre></div><h2 id="删除垃圾信息" tabindex="-1">删除垃圾信息 <a class="header-anchor" href="#删除垃圾信息" aria-label="Permalink to &quot;删除垃圾信息&quot;">​</a></h2><p>(仅适合 Leaf 或者 Gale)</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-Dgale.log.warning.root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Dgale.log.warning.offline.mode=false</span></span></code></pre></div><h2 id="更快的安全随机数生成器" tabindex="-1">更快的安全随机数生成器 <a class="header-anchor" href="#更快的安全随机数生成器" aria-label="Permalink to &quot;更快的安全随机数生成器&quot;">​</a></h2><p>(仅适合 Linux 和 MacOS 系统, 在 Windows 上无效)</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-Djava.security.egd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=file:/dev/urandom</span></span></code></pre></div><h2 id="异步输出-jvm-调试日志" tabindex="-1">异步输出 JVM 调试日志 <a class="header-anchor" href="#异步输出-jvm-调试日志" aria-label="Permalink to &quot;异步输出 JVM 调试日志&quot;">​</a></h2><p>(仅适合 Java17 及以上)</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> -Xlog:async</span></span></code></pre></div><p>异步输出 Java 统一日志系统(Unified Logging)打印的 JVM 调试信息</p><p>仅在使用 -Xlog:gc 等 flag 开启 JVM 调试信息打印的时候发挥作用</p><h3 id="更长的-keepalive-时间" tabindex="-1">更长的 KeepAlive 时间 <a class="header-anchor" href="#更长的-keepalive-时间" aria-label="Permalink to &quot;更长的 KeepAlive 时间&quot;">​</a></h3><p>(仅适合 Paper 和 Paper Fork)</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-Dpaper.playerconnection.keepalive</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=60</span></span></code></pre></div><p>如果你的网络不好，可以适当延长 keepalive 时间，打开<a href="/docs-java/process/maintenance/optimize/go#心跳连接">alternate-keepalive</a></p><h3 id="禁用文件夹遍历和符号链接验证" tabindex="-1">禁用文件夹遍历和符号链接验证 <a class="header-anchor" href="#禁用文件夹遍历和符号链接验证" aria-label="Permalink to &quot;禁用文件夹遍历和符号链接验证&quot;">​</a></h3><p>(仅适合 Paper 和 Paper Fork)</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-Dpaper.disableWorldSymlinkValidation</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div><p>在加载世界时禁用文件夹遍历和符号链接验证.显著提高大型世界的加载速度</p>',46)]))}const g=s(l,[["render",p]]);export{c as __pageData,g as default};
